SKILL={
	SKILL_EXECUTION_TYPE=,
}
SKILL:[SPELL,HERO_SPECIALTY_SKILL,HERO_SECONDARY_SKILL,UNIT_SKILL]

SKILL_EXECUTION_TYPE:[ACTIVE,PASSIVE]
CHANNELLING:[NOT_APPLICABLE,INSTANT]

SPELL:[
	SPELL_BLOODLUST,
	SPELL_CURE,
	SPELL_CURSE,
	SPELL_HASTE,
	SPELL_STONE_SKIN,
	SPELL_DISRUPTING_RAY,
]

HERO_SPECIALTY_SKILL:[
	SPECIALTY_SKILL_BALLISTA,
	SPECIALTY_SKILL_DISRUPTING_RAY,
]

HERO_SECONDARY_SKILL:[
	SECONDARY_SKILL_SCOUTING,
	SECONDARY_SKILL_EARTH_MAGIC,
	SECONDARY_SKILL_TACTICS,
	SECONDARY_SKILL_LOGISTICS,
	SECONDARY_SKILL_NECROMANCY,
	SECONDARY_SKILL_RESISTANCE,
	SECONDARY_SKILL_LEADERSHIP,
	SECONDARY_SKILL_ARTILLERY,
	SECONDARY_SKILL_WISDOM,
	SECONDARY_SKILL_AIR_MAGIC,
]

UNIT_SKILL:[
	SKILL_ARCHANGEL_RESURRECTION,
	SKILL_ARCHANGEL_HATRED,
	SKILL_ARCHANGEL_MORALE_BOOST,
	SKILL_PHOENIX_REBIRTH,
	SKILL_MAGIC_RESISTANCE,
]

SPECIALTY_SKILL=HERO_SPECIALTY_SKILL # Direct list assignment
SECONDARY_SKILL=HERO_SECONDARY_SKILL # Direct list assignment

##########
# Spells #
##########
#####################
# Spells\Fire Magic #
#####################
SPELL_BLOODLUST:[SPELL_BLOODLUST_BASIC,SPELL_BLOODLUST_ADVANCED,SPELL_BLOODLUST_EXPERT]
SPELL_BLOODLUST(UNIT,EXECUTE_WHEN,ATTACK_BONUS,TARGET_TYPE,TARGET_COUNT,DURATION)={
	EXECUTION=ACTIVE,
	EXECUTE_WHEN=EXECUTE_WHEN,
	CHANNELLING=INSTANT,
	TARGET_TYPE=TARGET_TYPE,
	EXCLUDED_TARGETS=[UNDEAD,NONLIVING,ELEMENTAL,MACHINE],
	LABELS=[FIRE_MAGIC,BUFF],
	RESULTS={
		FUNCTION=FUNC_BLOODLUST,
		FUNCTION_PARAMETERS=[UNIT,DURATION,ATTACK_BONUS,UNIT.MELEE_ATTACK],
	},
	MAGIC_GUIDE_APPEARANCE_PROBABILITY={
		INFERNO=0.53,
		NECROPOLIS=0.32,
		DUNGEON=0.3,
		STRONGHOLD=0.53,
		FORTRESS=0.31,
		CONFLUX=0.31,
	},
}
SPELL_BLOODLUST_BASIC=SPELL_BLOODLUST(?,AFTER_USER_SELECT_UNIT,3,FRIENDLY_SINGLE,?)
SPELL_BLOODLUST_ADVANCED=SPELL_BLOODLUST(?,AFTER_USER_SELECT_UNIT,6,FRIENDLY_SINGLE,?)
SPELL_BLOODLUST_EXPERT=SPELL_BLOODLUST(?,AFTER_USER_SELECT_SKILL,6,FRIENDLY_ALL,?)

SPELL_CURSE:[SPELL_CURSE_BASIC,SPELL_CURSE_ADVANCED,SPELL_CURSE_EXPERT]
SPELL_CURSE(UNIT,EXECUTE_WHEN,DURATION,TARGET_TYPE)={
	EXECUTION=ACTIVE,
	EXECUTE_WHEN=EXECUTE_WHEN,
	CHANNELLING=INSTANT,
	TARGET_TYPE=TARGET_TYPE,
	EXCLUDED_TARGET=[UNDEAD,NONLIVING,ELEMENTAL,MACHINE],
	LABELS=[MIND_MAGIC,FIRE_MAGIC,DEBUFF],
	RESULTS={
		FUNCTION=FUNC_CURSE,
		FUNCTION_PARAMETERS=[UNIT,DURATION],
	},
	MAGIC_GUIDE_APPEARANCE_PROBABILITY={
		TOWER=0.25,
		TOWER_NO_LIB=0.20,
		NECROPOLIS=0.54,
		INFERNO=0.31,
		DUNGEON=0.54,
	},
}
SPELL_CURSE_BASIC=SPELL_CURSE(?,AFTER_USER_SELECT_UNIT,?,FRIENDLY_SINGLE)
SPELL_CURSE_ADVANCED=SPELL_CURSE(?,AFTER_USER_SELECT_UNIT,?,FRIENDLY_SINGLE)
SPELL_CURSE_EXPERT=SPELL_CURSE(?,AFTER_USER_SELECT_SKILL,?,FRIENDLY_ALL)


######################
# Spells\Water Magic #
######################
SPELL_CURE:[SPELL_CURE_BASIC,SPELL_CURE_ADVANCED,SPELL_CURE_EXPERT]
SPELL_CURE(UNIT,EXECUTE_WHEN,CURE_POINT,TARGET_TYPE,POWER)={
	EXECUTION=ACTIVE,
	EXECUTE_WHEN=EXECUTE_WHEN,
	CHANNELLING=INSTANT,
	TARGET_TYPE=TARGET_TYPE,
	EXCLUDED_TARGETS=[UNDEAD,NONLIVING,ELEMENTAL,MACHINE],
	LABELS=[WATER_MAGIC,BUFF],
	RESULTS=[
		{
			FUNCTION=FUNC_CURE,
			FUNCTION_PARAMETERS=[CURE_POINT,POWER,UNIT.MAX_HP],
			ON=UNIT.HP,
		},
		{
			FUNCTION=FUNC_REMOVE_EFFECT,
			FUNCTION_PARAMETERS=[UNIT,NEGATIVE],
		},
	],
	MAGIC_GUIDE_APPEARANCE_PROBABILITY={
		CASTLE=0.54,
		RAMPART=0.54,
		TOWER=0.39,
		TOWER_NO_LIB=0.31,
		INFERNO=0.31,
		DUNGEON=0.3,
		STRONGHOLD=0.31,
		FORTRESS=0.53,
		CONFLUX=0.31,
	},
}
SPELL_CURE_BASIC=SPELL_CURE(?,AFTER_USER_SELECT_UNIT,10,FRIENDLY_SINGLE,?)
SPELL_CURE_ADVANCED=SPELL_CURE(?,AFTER_USER_SELECT_UNIT,20,FRIENDLY_SINGLE,?)
SPELL_CURE_EXPERT=SPELL_CURE(?,AFTER_USER_SELECT_SKILL,30,FRIENDLY_ALL,?)

#########################
# Hero Specialty Skills #
#########################
HERO_SPECIALTY_SKILL={
}
SPECIALTY_SKILL_BALLISTA={
	LABELS=[BUFF,PERMANENT_BUFF],
	RESULTS
}
#########################
# Hero Secondary Skills #
#########################
###############
# Unit Skills #
###############

SKILL_ARCHANGEL_RESURRECTION(STACK_NUMBER)={
	EXECUTION=ACTIVE,
	EXECUTE_WHEN=AFTER_USER_SELECT_UNIT,
	CHANNELLING=INSTANT,
	DURATION=PERMANENT,
	TARGET_TYPE=FRIENDLY_SINGLE,
	TARGET_COUNT=1,
	EXCLUDED_TARGET=[UNDEAD,NONLIVING,ELEMENTAL,MACHINE],
	RESULTS={
		ON=HP,
		FUNCTION=MULTIPLY,
		FUNCTION_PARAMETERS=[100,STACK_NUMBER],
	},
}

SKILL_HATRED(TARGET_LABELS,DAMAGE)={
	EXECUTION=PASSIVE,
	EXECUTE_WHEN=WHOLE_BATTLE,
	CHANNELLING=NOT_APPLICABLE,
	DURATION=BATTLE,
	TARGET_TYPE=ENEMY_BY_TYPE,
	TARGET=TARGET,
	RESULTS={
		ON=DAMAGE,
		FUNCTION=[FUNC_HATRED(1.5,DAMAGE,],
		FUNCTION_PARAMETERS=[1.5,ON],
	},
}

SKILL_HATRED:[
	SKILL_ARCHANGEL_HATRED,
	SKILL_ANGEL_HATRED,
	SKILL_ARCHDEMON_HATRED,
	SKILL_DEMON_HATRED,
	SKILL_BLACK_DRAGON_HATRED
]

# Skill inheritance
SKILL_ARCHANGEL_HATRED=SKILL_HATRED([DEVIL,ARCHDEVIL],DAMAGE)

# Archangel Morale Boost is applied for the whole battle.
# Returns the modified/boosted morale on all friendly units.
SKILL_ARCHANGEL_MORALE_BOOST={
	EXECUTION=PASSIVE,
	EXECUTE_WHEN=WHOLE_BATTLE,
	CHANNELLING=NOT_APPLICABLE,
	DURATION=BATTLE,
	TARGET_TYPE=FRIENDLY_ALL,
	EXCLUDED_TARGET=[UNDEAD,NONLIVING,ELEMENTAL,MACHINE],
	RESULTS={
		ON=MORALE,
		FUNCTION=ADD,
		FUNCTION_PARAMETERS=[1,ON],
	},
}

# Phoenix rebirth is triggered after a Phoenix stack enters Death state.
# Requires the stack's stack number.
# Returns the stack number which can be revived.
SKILL_PHOENIX_REBIRTH(STACK_NUMBER)={
	EXECUTION=PASSIVE,
	EXECUTE_WHEN=AFTER_DEATH,
	CHANNELLING=NOT_APPLICABLE,
	DURATION=PERMANENT,
	TARGET_TYPE=SELF,
	RESULTS={
		ON=STACK_NUMBER,
		FUNCTION=FUNC_PHOENIX_REBIRTH,
		FUNCTION_PARAMETERS=[0.2,STACK_NUMBER],
	}
}

# Magic resistance is settled when a unit is hit by magic.
# Requires the magic's labels, and the incoming damage.
# Returns the damage after resistance is applied.
SKILL_MAGIC_RESISTANCE(TARGET_MAGIC,RESISTANCE_RATIO,HIT_BY_MAGIC_TYPE,DAMAGE)={
	EXECUTION=PASSIVE_BEFORE_HIT_BY_MAGIC,
	EXECUTE_WHEN=BEFORE_HIT_BY,
	EXECUTION_WHEN_PARAMETER=MAGIC,
	EXECUTION_FUNCTION_PARAMETER=INCOMING_MAGIC_TYPE,
	CHANNELLING=NOT_APPLICABLE,
	DURATION=BATTLE,
	TARGET_TYPE=SELF,
	TARGET=TARGET_MAGIC,
	RESULTS={
		ON=DAMAGE,
		FUNCTION=FUNC_MAGIC_RESISTANCE,
		FUNCTION_PARAMETERS=[TARGET,HIT_BY_MAGIC_TYPE,RESISTANCE_RATIO,DAMAGE],
	},
}
